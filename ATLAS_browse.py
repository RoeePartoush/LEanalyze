#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Feb  9 00:44:50 2021

@author: roeepartoush
"""


# %%
import numpy as np
from scipy import signal as sp
from scipy import interpolate as intp
# Set up matplotlib
import matplotlib.pyplot as plt
#%matplotlib inline
from astropy.io import fits
from astropy import wcs

from astropy import units as u
from astropy.coordinates import Angle

from astropy.wcs.utils import wcs_to_celestial_frame
from astropy.coordinates import SkyCoord

import LeTools_Module as LeT
from scipy.ndimage import gaussian_filter

import pandas as pd
import re
import os
get_ipython().run_line_magic('matplotlib', 'qt')

# %%
plt.close('all')
global image_files
image_files = []
mjds = []
decs = []
ras = []
home_dir = 'https://stsci-transients.stsci.edu/atlas/cand/ROEE/'

tmpDF = lstDF.iloc[np.logical_and(np.logical_and(np.array(lstDF['DEC'])==-28,np.array(lstDF['RA'])==257),np.array(lstDF['MJD'])>=8400)] 

for i in np.arange(len(tmpDF)):
    image_files.append(tmpDF.iloc[i]['flnms'][0:22])


DF = pd.DataFrame(data=image_files, columns=['flnm'])
DF.sort_values(['flnm'],inplace=True)
 
inds = list(DF.index)
image_files_tmp = image_files.copy()
for i in np.arange(len(inds)):
    image_files[i] = image_files_tmp[inds[i]]


[image_data, hdu_list_list, aximg2, wcs_list2] = LeT.load_difimg_atlas(home_dir,image_files, FS=0,gss_FWHM=None)


# %%

lst = ['dec-28/257-28.58400.wp.fits',
'dec-28/257-28.58500.wp.fits',
'dec-28/257-28.58550.wp.fits',
'dec-28/257-28.58600.wp.fits',
'dec-28/257-28.58650.wp.fits',
'dec-04/031-04.58400.wp.fits',
'dec-04/031-04.58450.wp.fits',
'dec-04/031-04.58500.wp.fits',
'dec-04/031-04.58650.wp.fits',
'dec-04/076-04.58400.wp.fits',
'dec-04/076-04.58450.wp.fits',
'dec-04/076-04.58500.wp.fits',
'dec-04/076-04.58550.wp.fits',
'dec-04/076-04.58650.wp.fits',
'dec-05/082-05.58400.wp.fits',
'dec-05/082-05.58450.wp.fits',
'dec-05/082-05.58500.wp.fits',
'dec-05/082-05.58550.wp.fits',
'dec-05/082-05.58650.wp.fits',
'dec-05/195-05.58450.wp.fits',
'dec-05/195-05.58500.wp.fits',
'dec-05/195-05.58550.wp.fits',
'dec-05/195-05.58600.wp.fits',
'dec-05/195-05.58650.wp.fits',
'dec-05/211-05.58450.wp.fits',
'dec-05/211-05.58500.wp.fits',
'dec-05/211-05.58550.wp.fits',
'dec-05/211-05.58600.wp.fits',
'dec-05/211-05.58650.wp.fits',
'dec-06/052-06.58400.wp.fits',
'dec-06/052-06.58450.wp.fits',
'dec-06/052-06.58500.wp.fits',
'dec-06/052-06.58550.wp.fits',
'dec-06/052-06.58650.wp.fits',
'dec-06/057-06.58400.wp.fits',
'dec-06/057-06.58450.wp.fits',
'dec-06/057-06.58500.wp.fits',
'dec-06/057-06.58550.wp.fits',
'dec-06/057-06.58650.wp.fits',
'dec-06/187-06.58450.wp.fits',
'dec-06/187-06.58500.wp.fits',
'dec-06/187-06.58550.wp.fits',
'dec-06/187-06.58600.wp.fits',
'dec-06/187-06.58650.wp.fits',
'dec+08/044+08.58400.wp.fits',
'dec+08/044+08.58450.wp.fits',
'dec+08/044+08.58500.wp.fits',
'dec+08/044+08.58550.wp.fits',
'dec+08/044+08.58650.wp.fits',
'dec+08/099+08.58400.wp.fits',
'dec+08/099+08.58450.wp.fits',
'dec+08/099+08.58500.wp.fits',
'dec+08/099+08.58550.wp.fits',
'dec+08/099+08.58600.wp.fits',
'dec+08/153+08.58400.wp.fits',
'dec+08/153+08.58450.wp.fits',
'dec+08/153+08.58500.wp.fits',
'dec+08/153+08.58550.wp.fits',
'dec+08/153+08.58600.wp.fits',
'dec+08/153+08.58650.wp.fits',
'dec+08/241+08.58400.wp.fits',
'dec+08/241+08.58450.wp.fits',
'dec+08/241+08.58500.wp.fits',
'dec+08/241+08.58550.wp.fits',
'dec+08/241+08.58600.wp.fits',
'dec+08/241+08.58650.wp.fits',
'dec+12/082+12.58400.wp.fits',
'dec+12/082+12.58450.wp.fits',
'dec+12/082+12.58500.wp.fits',
'dec+12/082+12.58550.wp.fits',
'dec+12/082+12.58600.wp.fits',
'dec-16/248-16.58400.wp.fits',
'dec-16/248-16.58450.wp.fits',
'dec-16/248-16.58500.wp.fits',
'dec-16/248-16.58550.wp.fits',
'dec-16/248-16.58600.wp.fits',
'dec-16/248-16.58650.wp.fits',
'dec-17/058-17.58400.wp.fits',
'dec-17/058-17.58450.wp.fits',
'dec-17/058-17.58500.wp.fits',
'dec-17/058-17.58550.wp.fits',
'dec-17/058-17.58650.wp.fits',
'dec+23/236+23.58400.wp.fits',
'dec+23/236+23.58450.wp.fits',
'dec+23/236+23.58500.wp.fits',
'dec+23/236+23.58550.wp.fits',
'dec+23/236+23.58600.wp.fits',
'dec+23/236+23.58650.wp.fits',
'dec+24/067+24.58400.wp.fits',
'dec+24/067+24.58450.wp.fits',
'dec+24/067+24.58500.wp.fits',
'dec+24/067+24.58550.wp.fits',
'dec+24/067+24.58650.wp.fits',
'dec+24/068+24.58400.wp.fits',
'dec+24/068+24.58450.wp.fits',
'dec+24/068+24.58500.wp.fits',
'dec+24/068+24.58550.wp.fits',
'dec+24/068+24.58650.wp.fits',
'dec+26/066+26.58400.wp.fits',
'dec+26/066+26.58450.wp.fits',
'dec+26/066+26.58500.wp.fits',
'dec+26/066+26.58550.wp.fits',
'dec+26/066+26.58650.wp.fits',
'dec+26/069+26.58400.wp.fits',
'dec+26/069+26.58450.wp.fits',
'dec+26/069+26.58500.wp.fits',
'dec+26/069+26.58550.wp.fits',
'dec+26/069+26.58650.wp.fits',
'dec+26/084+26.58400.wp.fits',
'dec+26/084+26.58450.wp.fits',
'dec+26/084+26.58500.wp.fits',
'dec+26/084+26.58550.wp.fits',
'dec+26/084+26.58600.wp.fits',
'dec+26/202+26.58450.wp.fits',
'dec+26/202+26.58500.wp.fits',
'dec+26/202+26.58550.wp.fits',
'dec+26/202+26.58600.wp.fits',
'dec+26/202+26.58650.wp.fits',
'dec+26/217+26.58450.wp.fits',
'dec+26/217+26.58500.wp.fits',
'dec+26/217+26.58550.wp.fits',
'dec+26/217+26.58600.wp.fits',
'dec+26/217+26.58650.wp.fits',
'dec-36/082-36.58400.wp.fits',
'dec-36/082-36.58450.wp.fits',
'dec-36/082-36.58500.wp.fits',
'dec-36/082-36.58550.wp.fits',
'dec+46/071+46.58400.wp.fits',
'dec+46/071+46.58450.wp.fits',
'dec+46/071+46.58500.wp.fits',
'dec+46/071+46.58550.wp.fits',
'dec+52/130+52.58400.wp.fits',
'dec+52/130+52.58450.wp.fits',
'dec+52/130+52.58500.wp.fits',
'dec+52/130+52.58550.wp.fits',
'dec+52/130+52.58600.wp.fits',
'dec+52/139+52.58400.wp.fits',
'dec+52/139+52.58450.wp.fits',
'dec+52/139+52.58500.wp.fits',
'dec+52/139+52.58550.wp.fits',
'dec+52/139+52.58600.wp.fits',
'dec+52/345+52.58400.wp.fits',
'dec+52/345+52.58450.wp.fits',
'dec+52/345+52.58500.wp.fits',
'dec+52/345+52.58600.wp.fits',
'dec+52/345+52.58650.wp.fits',
'dec+52/349+52.58400.wp.fits',
'dec+52/349+52.58450.wp.fits',
'dec+52/349+52.58500.wp.fits',
'dec+52/349+52.58600.wp.fits',
'dec+52/349+52.58650.wp.fits',
'dec+52/350+52.58400.wp.fits',
'dec+52/350+52.58450.wp.fits',
'dec+52/350+52.58500.wp.fits',
'dec+52/350+52.58600.wp.fits',
'dec+52/350+52.58650.wp.fits',
'dec+53/348+53.58400.wp.fits',
'dec+53/348+53.58450.wp.fits',
'dec+53/348+53.58500.wp.fits',
'dec+53/348+53.58600.wp.fits',
'dec+53/348+53.58650.wp.fits',
'dec+54/003+54.58400.wp.fits',
'dec+54/003+54.58450.wp.fits',
'dec+54/003+54.58500.wp.fits',
'dec+54/003+54.58600.wp.fits',
'dec+54/003+54.58650.wp.fits',
'dec+55/003+55.58400.wp.fits',
'dec+55/003+55.58450.wp.fits',
'dec+55/003+55.58500.wp.fits',
'dec+55/003+55.58600.wp.fits',
'dec+55/003+55.58650.wp.fits',
'dec+57/004+57.58400.wp.fits',
'dec+57/004+57.58450.wp.fits',
'dec+57/004+57.58500.wp.fits',
'dec+57/004+57.58600.wp.fits',
'dec+57/004+57.58650.wp.fits',
'dec+57/006+57.58400.wp.fits',
'dec+57/006+57.58450.wp.fits',
'dec+57/006+57.58500.wp.fits',
'dec+57/006+57.58600.wp.fits',
'dec+57/006+57.58650.wp.fits',
'dec+57/325+57.58400.wp.fits',
'dec+57/325+57.58450.wp.fits',
'dec+57/325+57.58500.wp.fits',
'dec+57/325+57.58600.wp.fits',
'dec+57/325+57.58650.wp.fits',
'dec+57/326+57.58400.wp.fits',
'dec+57/326+57.58450.wp.fits',
'dec+57/326+57.58500.wp.fits',
'dec+57/326+57.58600.wp.fits',
'dec+57/326+57.58650.wp.fits',
'dec+57/339+57.58400.wp.fits',
'dec+57/339+57.58450.wp.fits',
'dec+57/339+57.58500.wp.fits',
'dec+57/339+57.58600.wp.fits',
'dec+57/339+57.58650.wp.fits',
'dec+58/012+58.58400.wp.fits',
'dec+58/012+58.58450.wp.fits',
'dec+58/012+58.58500.wp.fits',
'dec+58/012+58.58600.wp.fits',
'dec+58/012+58.58650.wp.fits',
'dec+58/022+58.58400.wp.fits',
'dec+58/022+58.58450.wp.fits',
'dec+58/022+58.58500.wp.fits',
'dec+58/022+58.58550.wp.fits',
'dec+58/022+58.58650.wp.fits',
'dec+58/323+58.58400.wp.fits',
'dec+58/323+58.58450.wp.fits',
'dec+58/323+58.58500.wp.fits',
'dec+58/323+58.58600.wp.fits',
'dec+58/323+58.58650.wp.fits',
'dec+58/325+58.58400.wp.fits',
'dec+58/325+58.58450.wp.fits',
'dec+58/325+58.58500.wp.fits',
'dec+58/325+58.58600.wp.fits',
'dec+58/325+58.58650.wp.fits',
'dec+59/005+59.58400.wp.fits',
'dec+59/005+59.58450.wp.fits',
'dec+59/005+59.58500.wp.fits',
'dec+59/005+59.58600.wp.fits',
'dec+59/005+59.58650.wp.fits',
'dec+59/013+59.58400.wp.fits',
'dec+59/013+59.58450.wp.fits',
'dec+59/013+59.58500.wp.fits',
'dec+59/013+59.58550.wp.fits',
'dec+59/013+59.58600.wp.fits',
'dec+59/013+59.58650.wp.fits',
'dec+59/014+59.58400.wp.fits',
'dec+59/014+59.58450.wp.fits',
'dec+59/014+59.58500.wp.fits',
'dec+59/014+59.58550.wp.fits',
'dec+59/014+59.58600.wp.fits',
'dec+59/014+59.58650.wp.fits',
'dec+59/015+59.58400.wp.fits',
'dec+59/015+59.58450.wp.fits',
'dec+59/015+59.58500.wp.fits',
'dec+59/015+59.58550.wp.fits',
'dec+59/015+59.58600.wp.fits',
'dec+59/015+59.58650.wp.fits',
'dec+59/016+59.58400.wp.fits',
'dec+59/016+59.58450.wp.fits',
'dec+59/016+59.58500.wp.fits',
'dec+59/016+59.58550.wp.fits',
'dec+59/016+59.58600.wp.fits',
'dec+59/016+59.58650.wp.fits',
'dec+59/017+59.58400.wp.fits',
'dec+59/017+59.58450.wp.fits',
'dec+59/017+59.58500.wp.fits',
'dec+59/017+59.58550.wp.fits',
'dec+59/017+59.58600.wp.fits',
'dec+59/017+59.58650.wp.fits',
'dec+59/320+59.58400.wp.fits',
'dec+59/320+59.58450.wp.fits',
'dec+59/320+59.58600.wp.fits',
'dec+59/320+59.58650.wp.fits',
'dec+59/353+59.58400.wp.fits',
'dec+59/353+59.58450.wp.fits',
'dec+59/353+59.58500.wp.fits',
'dec+59/353+59.58600.wp.fits',
'dec+59/353+59.58650.wp.fits',
'dec+59/354+59.58400.wp.fits',
'dec+59/354+59.58450.wp.fits',
'dec+59/354+59.58500.wp.fits',
'dec+59/354+59.58600.wp.fits',
'dec+59/354+59.58650.wp.fits',
'dec+60/350+60.58400.wp.fits',
'dec+60/350+60.58450.wp.fits',
'dec+60/350+60.58500.wp.fits',
'dec+60/350+60.58600.wp.fits',
'dec+60/350+60.58650.wp.fits',
'dec+60/352+60.58400.wp.fits',
'dec+60/352+60.58450.wp.fits',
'dec+60/352+60.58500.wp.fits',
'dec+60/352+60.58600.wp.fits',
'dec+60/352+60.58650.wp.fits',
'dec+63/016+63.58400.wp.fits',
'dec+63/016+63.58450.wp.fits',
'dec+63/016+63.58500.wp.fits',
'dec+63/016+63.58550.wp.fits',
'dec+63/016+63.58600.wp.fits',
'dec+63/016+63.58650.wp.fits',
'dec+63/020+63.58400.wp.fits',
'dec+63/020+63.58450.wp.fits',
'dec+63/020+63.58500.wp.fits',
'dec+63/020+63.58550.wp.fits',
'dec+63/020+63.58600.wp.fits',
'dec+63/020+63.58650.wp.fits',
'dec+63/036+63.58400.wp.fits',
'dec+63/036+63.58450.wp.fits',
'dec+63/036+63.58500.wp.fits',
'dec+63/036+63.58550.wp.fits',
'dec+63/036+63.58650.wp.fits',
'dec+64/028+64.58400.wp.fits',
'dec+64/028+64.58450.wp.fits',
'dec+64/028+64.58500.wp.fits',
'dec+64/028+64.58550.wp.fits',
'dec+64/028+64.58650.wp.fits',
'dec+64/346+64.58400.wp.fits',
'dec+64/346+64.58450.wp.fits',
'dec+64/346+64.58500.wp.fits',
'dec+64/346+64.58600.wp.fits',
'dec+64/346+64.58650.wp.fits',
'dec+64/348+64.58400.wp.fits',
'dec+64/348+64.58450.wp.fits',
'dec+64/348+64.58500.wp.fits',
'dec+64/348+64.58600.wp.fits',
'dec+64/348+64.58650.wp.fits',
'dec+65/012+65.58400.wp.fits',
'dec+65/012+65.58450.wp.fits',
'dec+65/012+65.58500.wp.fits',
'dec+65/012+65.58600.wp.fits',
'dec+65/012+65.58650.wp.fits',
'dec+66/002+66.58400.wp.fits',
'dec+66/002+66.58450.wp.fits',
'dec+66/002+66.58500.wp.fits',
'dec+66/002+66.58600.wp.fits',
'dec+66/002+66.58650.wp.fits',
'dec+67/310+67.58400.wp.fits',
'dec+67/310+67.58450.wp.fits',
'dec+67/310+67.58550.wp.fits',
'dec+67/310+67.58600.wp.fits',
'dec+67/310+67.58650.wp.fits',
'dec+67/314+67.58400.wp.fits',
'dec+67/314+67.58450.wp.fits',
'dec+67/314+67.58550.wp.fits',
'dec+67/314+67.58600.wp.fits',
'dec+67/314+67.58650.wp.fits',
'dec+68/318+68.58400.wp.fits',
'dec+68/318+68.58450.wp.fits',
'dec+68/318+68.58550.wp.fits',
'dec+68/318+68.58600.wp.fits',
'dec+68/318+68.58650.wp.fits',
'dec+73/207+73.58400.wp.fits',
'dec+73/207+73.58450.wp.fits',
'dec+73/207+73.58500.wp.fits',
'dec+73/207+73.58550.wp.fits',
'dec+73/207+73.58600.wp.fits',
'dec+73/207+73.58650.wp.fits',
'dec+89/000+89.58400.wp.fits',
'dec+89/000+89.58450.wp.fits',
'dec+89/000+89.58500.wp.fits',
'dec+89/000+89.58550.wp.fits',
'dec+89/000+89.58600.wp.fits',
'dec+89/000+89.58650.wp.fits']

lstDF = pd.DataFrame(data=lst,columns=['flnms'])
for i in np.arange(len(lst)):
    lstDF.loc[i,'DEC'] = int(lst[i][3:6])
    lstDF.loc[i,'RA']  = int(lst[i][7:10])
    lstDF.loc[i,'MJD'] = int(lst[i][14:19])